slave:
  build: slave
  links:
    - master:master
    - repo:repo
  command: bash -c '/etc/init.d/jenkins-slave start && while true; do sleep 1; done'

master:
  build: jenkins
  ports:
    - "0.0.0.0:8080:8080"
  command: bash -c 'service jenkins start && while true; do sleep 1; done'


repo:
  build: repo
  links:
    - master:master
  ports:
  - "0.0.0.0:8081:80"
  command: bash -c 'service apache2 start && echo "starting apache" && /etc/init.d/jenkins-slave start && echo "starting repo" && while true; do sleep 1; done'
